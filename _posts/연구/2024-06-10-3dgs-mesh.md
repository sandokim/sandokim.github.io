---
title: "[3D CV 연구] 3DGS input & output .ply properties & mesh"
last_modified_at: 2024-06-10
categories:
  - 연구
tags:
  - 연구
  - 3D CV
  - 3dgs
  - 3d gaussian splatting
  - mesh
  - point cloud
excerpt: "3DGS input & output .ply properties & mesh"
use_math: true
classes: wide
---

3DGS는 point cloud를 생성하지, mesh를 생성하지는 않습니다.

3dgs의 output은 point_cloud를 .ply 형태로 내보냅니다. 저자는 mesh 자체를 directly produce하는 것은 계획하고 있지 않다고 밝혔습니다.

https://github.com/graphdeco-inria/gaussian-splatting/issues/125

![image](https://github.com/sandokim/sandokim.github.io/assets/74639652/acbc3eac-64ab-4a5e-8905-74bc07f44627)

하지만 3dgs로 얻은 .ply 파일인 point cloud에 poisson reconstruction을 적용하면 mesh를 생성해낼 수 있습니다.

**Meshlab**에서 표현되는 Vert의 의미는 일반적으로 point cloud 또는 3D mesh에 있어서 각각의 점(정점, vertex)를 의미합니다. 이 점들은 공간 내 위치와 해당 위치의 속성(i.e. color, normal vector)을 나타냅니다.

3dgs에서 각 Vert(정점) 데이터는 다음과 같습니다.

### 1) Random initialization으로 생성한 input.ply는 다음을 포함합니다.

- x, y, z (position)
- nx, ny, nz (normal)
- red, green, blue (color)

첫 5개의 Vert(정점) 데이터를 출력하면 다음과 같습니다

```python
[x, y, z, nx, ny, nz, red, green, blue]
[ 0.126915112,  0.55949235,  0.267184764, 0.0, 0.0, 0.0, 127, 127, 127]
[ 0.116696276, -0.198497519,  0.379324704, 0.0, 0.0, 0.0, 127, 127, 127]
[-0.162273258,  1.01860976,  1.20552313, 0.0, 0.0, 0.0, 127, 127, 127]
[-0.303052038,  0.758485079,  0.0751267895, 0.0, 0.0, 0.0, 127, 127, 127]
[ 0.176915854,  1.10655129, -1.11530626, 0.0, 0.0, 0.0, 127, 127, 127]
...
```

### 2) Depth camera로 촬영하여 얻은 point cloud .ply 데이터는 다음을 포함합니다.

- x, y, z (position)
- nx, ny, nz (normal)
- red, green, blue (color)

첫 5개의 Vert(정점) 데이터를 출력하면 다음과 같습니다.

```python
[x, y, z, nx, ny, nz, red, green, blue]
[-0.02453409, 0.11095615, 0.05512903, 0.01242013, 0.56303861, 0.82633723, 0.0, 0.0, 0.0]
[-0.02339740, 0.11094624, 0.05511869, 0.01242013, 0.56303861, 0.82633723, 0.0, 235.0, 254.0]
[-0.02226834, 0.11093641, 0.05510842, 0.01242013, 0.56303861, 0.82633729, 0.0, 235.0, 254.0]
[-0.03917740, 0.10962883, 0.05625351, 0.01245886, 0.57928908, 0.81502695, 0.0, 229.0, 254.0]
[-0.03804834, 0.10961899, 0.05624324, 0.01245886, 0.57928908, 0.81502695, 0.0, 229.0, 254.0]
...
```

***즉, random initialization으로 생성하는 input.ply와 depth camera로 depth 정보까지 얻어 생성한 input.ply가 가지는 정보의 종류는 같습니다.***

### 3) 3dgs output인 point_cloud.ply는 다음을 포함합니다.

- x, y, z (position)
- nx, ny, nz (normal)
- f_dc_0, f_dc_1, f_dc_2 (특정 필터링 또는 추가 속성)
- f_rest_0 ~ f_rest_2 (다양한 추가 속성)
- f_rest_3 ~ f_rest_44 (다양한 추가 속성, 3dgs original code에서는 0의 값으로 출력됨을 확인함)
- opacity (불투명도)
- scale_n (스케일 정보)
- rot_n (회전 정보)

3dgs의 output인 point_cloud.ply의 첫 번째 Vert(정점) 데이터를 출력하면 다음과 같습니다.

**nx, ny, nz, f_rest_3 ~ f_rest_44는 값이 0이고, rot_1, rot_2, rot_3, rot_4는 1.0, 0.0, 0.0, 0.0의 값을 가집니다.**

```python
[x, y, z, nx, ny, nz, f_dc_0, f_dc_1, f_dc_2, f_rest_0, f_rest_1, f_rest_2, f_rest_3, f_rest_4, f_rest_5, f_rest_6, f_rest_7, f_rest_8, f_rest_9, f_rest_10, f_rest_11, f_rest_12, f_rest_13, f_rest_14, f_rest_15, f_rest_16, f_rest_17, f_rest_18, f_rest_19, f_rest_20, f_rest_21, f_rest_22, f_rest_23, f_rest_24, f_rest_25, f_rest_26, f_rest_27, f_rest_28, f_rest_29, f_rest_30, f_rest_31, f_rest_32, f_rest_33, f_rest_34, f_rest_35, f_rest_36, f_rest_37, f_rest_38, f_rest_39, f_rest_40, f_rest_41, f_rest_42, f_rest_43, f_rest_44, opacity, scale_0, scale_1, scale_2, rot_0, rot_1, rot_2, rot_3]
[ 0.12691511,  0.55949235,  0.26718476,  0.0,  0.0,  0.0, -0.0069508, -0.0069508, -0.0069508,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -4.59511995, -3.30952573, -3.30952573, -3.30952573,  1.0,  0.0,  0.0,  0.0]
[-0.16227326,  1.01860976,  1.20552313,  0.0,  0.0,  0.0, -0.0069508, -0.0069508, -0.0069508,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -4.59511995, -3.57876754, -3.57876754, -3.57876754,  1.0,  0.0,  0.0,  0.0]
[-0.30305204,  0.75848508,  0.07512679,  0.0,  0.0,  0.0, -0.0069508, -0.0069508, -0.0069508,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -4.59511995, -2.97908568, -2.97908568, -2.97908568,  1.0,  0.0,  0.0,  0.0]
[ 0.17691585,  1.10655129, -1.11530626,  0.0,  0.0,  0.0, -0.0069508, -0.0069508, -0.0069508,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -4.59511995, -3.00402117, -3.00402117, -3.00402117,  1.0,  0.0,  0.0,  0.0]
[-1.0734638 , -1.24743211,  0.8648116 ,  0.0,  0.0,  0.0, -0.0069508, -0.0069508, -0.0069508,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0,  0.0, -4.59511995, -3.3899107 , -3.3899107 , -3.3899107 ,  1.0,  0.0,  0.0,  0.0]
...
```

input은 color에 대해 Vert를 가지고 있으나,

![image](https://github.com/sandokim/sandokim.github.io/assets/74639652/97d1ce00-d53d-4bd0-8d6a-0d00edb7e279)

output은 color에 대해 Vert를 가지고 있지 않습니다.

![image](https://github.com/sandokim/sandokim.github.io/assets/74639652/4b63bd79-95da-48b6-82d8-5c4b682907d8)

이는 point cloud가 output으로 저장될 때 실제로 ['x', 'y', 'z', 'nx', 'ny', 'nz']로 저장되긴 하나 color에 대한 normal이 다른 형태로 저장되었기 때문입니다.

![image](https://github.com/sandokim/sandokim.github.io/assets/74639652/5d526f7f-e625-4891-b5b4-11835e4940e2)


![image](https://github.com/sandokim/sandokim.github.io/assets/74639652/3d640c8a-3a02-4918-a852-3e556d29056c)
